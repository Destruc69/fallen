<!DOCTYPE html>
<html>
<head>
    <title>My Forum</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="sidebar">
    <h2>Active Forums</h2>
    <ul id="forum-list"></ul>
    <button id="create-forum-button">Create Forum</button>
    <form id="create-forum-form" class="hidden">
        <label for="forum-name">Forum Name:</label>
        <input type="text" id="forum-name" required>
        <button type="submit">Create</button>
    </form>
</div>
<div id="chat">
    <h2 id="forum-title"></h2>
    <div id="message-box"></div>
    <form id="message-form">
        <input type="text" id="message-input" required>
        <button type="submit">Send</button>
    </form>
</div>
<script src="script.js"></script>
</body>
</html>

<style>
    body {
margin: 0;
padding: 0;
font-family: Arial, sans-serif;
}

#sidebar {
float: left;
width: 30%;
height: 100vh;
background-color: #eee;
padding: 10px;
box-sizing: border-box;
}

#chat {
float: left;
width: 70%;
height: 100vh;
background-color: #fff;
padding: 10px;
box-sizing: border-box;
}

#forum-list {
list-style: none;
padding: 0;
}

#forum-list li {
margin: 5px 0;
}

#forum-list a {
display: block;
padding: 5px;
background-color: #fff;
text-decoration: none;
color: #333;
}

#forum-list a.active {
background-color: #333;
color: #fff;
}

#message-box {
height: 70vh;
overflow-y: auto;
margin-bottom: 10px;
}

.hidden {
display: none;
}
</style>

<script>
    // Set your API endpoint and API key
const apiUrl = 'https://yourforumname.vanillacommunity.com/api/v2';
const apiKey = 'yourapikey';

// Function to fetch a list of forums from the API and display them in the sidebar
function getForums() {
  fetch(`${apiUrl}/categories`, {
    headers: {
      Authorization: `Bearer ${apiKey}`
    }
  })
    .then(response => response.json())
    .then(data => {
      console.log(data);
      // Display the list of forums in the sidebar
      const forumList = document.querySelector('#forum-list');
      forumList.innerHTML = '';
      data.forEach(forum => {
        const link = document.createElement('a');
        link.href = '#';
        link.dataset.id = forum.CategoryID;
        link.textContent = forum.Name;
        link.addEventListener('click', event => {
          event.preventDefault();
          setActiveForum(forum);
        });
        forumList.appendChild(link);
      });
    })
    .catch(error => {
      console.error(error);
    });
    // Function to set the active forum and display its messages
function setActiveForum(forum) {
// Set the active forum title
const forumTitle = document.querySelector('#forum-title');
forumTitle.textContent = forum.Name;

// Get the messages for the selected forum
fetch(${apiUrl}/categories/${forum.CategoryID}/discussions?sort=datecreated, {
headers: {
Authorization: Bearer ${apiKey}
}
})
.then(response => response.json())
.then(data => {
console.log(data);
// Display the messages in the message box
const messageBox = document.querySelector('#message-box');
messageBox.innerHTML = '';
data.forEach(message => {
const div = document.createElement('div');
div.classList.add('message');
div.innerHTML = <div class="author">${message.InsertUserID}</div> <div class="date">${new Date(message.DateInserted).toLocaleString()}</div> <div class="content">${message.Body}</div> ;
messageBox.appendChild(div);
});
  // Set the active forum ID as a data attribute on the message form
  const messageForm = document.querySelector('#message-form');
  messageForm.dataset.forumId = forum.CategoryID;

  // Display the message form
  messageForm.classList.remove('hidden');
})
.catch(error => {
  console.error(error);
});
}
// Function to send a message to the selected forum
function sendMessage(event) {
event.preventDefault();
const messageInput = document.querySelector('#message-input');
const message = messageInput.value;
const forumId = document.querySelector('#message-form').dataset.forumId;
fetch(${apiUrl}/categories/${forumId}/discussions, {
method: 'POST',
headers: {
'Content-Type': 'application/json',
Authorization: Bearer ${apiKey}
},
body: JSON.stringify({
Name: 'New message',
Body: message
})
})
.then(response => response.json())
.then(data => {
console.log(data);
// Add the new message to the message box
const messageBox = document.querySelector('#message-box');
const div = document.createElement('div');
div.classList.add('message');
div.innerHTML = <div class="author">${data.InsertUserID}</div> <div class="date">${new Date(data.DateInserted).toLocaleString()}</div> <div class="content">${data.Body}</div> ;
messageBox.appendChild(div);
// Clear the message input
messageInput.value = '';
})
.catch(error => {
console.error(error);
});
}

// Event listeners
document.addEventListener('DOMContentLoaded', getForums);
document.querySelector('#create-forum-button').addEventListener('click', event => {
event.preventDefault();
const createForumForm = document.querySelector('#create-forum-form');
createForumForm.classList.toggle('hidden');
});
document.querySelector('#create-forum-form').addEventListener('submit', event => {
event.preventDefault();
const forumName = document.querySelector('#forum-name').value;
fetch(${apiUrl}/categories, {
method: 'POST',
headers: {
'Content-Type': 'application/json',
Authorization: Bearer ${apiKey}
},
body: JSON.stringify({
Name: forumName
})
})
.then(response => response.json())
.then(data => {
console.log(data);
// Add the new forum to the forum list
const forumList = document.querySelector('#forum-list');
const link = document.createElement('a');
link.href = '#';
link.dataset.id = data.CategoryID;
link.textContent = data.Name;

// Set the new forum as the active forum
setActiveForum(data);

// Add click event listener to the new forum link
link.addEventListener('click', event => {
  event.preventDefault();
  setActiveForum(data);
});

// Append the new forum link to the sidebar list
forumList.appendChild(link);
</script>